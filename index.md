On the 17th of November, ArenaNet - the developer of an MMO game Guild Wars 2 - changed their payment provider for in-game purchases. Whether the change was for the better or worse is to be discussed, yet, I wanted to buy some *gems* (premium currency) to spend on cool items in the store. Having tried my usual payment method that turned out broken, I started exploring the new UI.

⠀

![New payment UI](./newui.png)

⠀

One of the options hidden under "Other" is Paysafecard. In this method, a customer first purchases a pre-paid code with usual means like credit card, cash etc., and then - during checkout - is redirected to the Paysafecard website where the code can be entered. The funds are then deducted from a virtual account represented by the code. 

The game makes it possible to finish this flow in a single window because it's using an embedded browser to display this whole UI. 

⠀

![Paysafecard option](./paysafe.png)

⠀

At some point when clicking through the Paysafecard interface, I noticed **my account now had an extra 1600 gems**. But I didn't make any transaction?!

Digging deeper, after retracing my steps I realized backing out of the Paysafecard UI using the blue "X" button, *without paying*, resulted in the chosen amount of gems being added to my account. I now had 3200 gems.

⠀

![I'm rich, you know](./3200.png)

⠀

At first I thought it's just a visual bug - the balance will surely reset back to normal after I reopen the trading UI or restart the game, right? Or so I was thinking, **until the emails arrived.**

⠀

![Email purchase confirmation, but I didn't pay](./email.png)

⠀

(note the highlight revealing black text on black background)

At this point I was facing a pretty serious vulnerability where anyone could get **endless amount of free premium currency**, only limited by how fast they could click through the UI. Since the game also lets players convert premium currency to in-game gold, the impact this bug could have had if exploited by a malicious factor would have been insane. 

In fact, a competing MMO from Amazon has been facing these issues recently, where [gold duplicatoin exploits have destroyed the in-game economy and led many people to quit](https://gamerant.com/new-world-gold-material-duping-economy/). So I did the responsible thing and went to report it.

⠀

![ArenaNet can't be messaged](./twitter.png)

⠀

Getting ahold of a live human at ArenaNet has proven difficult. My first thought to try `exploits@arena.net` only led me to realize [it has been disabled](https://www.reddit.com/r/Guildwars2/comments/hiv04q/psa_exploitsarenanet_has_been_disabled/). I submitted a support ticket instead (as advised in the post) and, with a healthy dose of skepticism, waited.

⠀

![Support ticket](./ticket.png)

⠀

About 30 minutes after my report, the payment UI went down briefly and then back up again. I didn't try the exploit for obvious reasons. Two hours later I got a reply confirming that the issue has been fixed.

⠀

![Ticket reply - issue fixed](./fixed.png)

⠀

---

⠀

How many players exactly have taken advantage of this bug? Only ArenaNet knows. **The root cause? Not given**, but I suspect a developer has left a debug condition in the code and it somehow managed to get into the live build. Like this:

`if (paymentSuccess || true) handleAddGems();`

What I *do* know is that ArenaNet let me keep half of the free gems, worth $20. So I guess I can put that towards my lifetime bug bounty stat. It's now at... $20. Progress!

⠀

But hey, at least I ~~got chicken~~ won't be getting banned for fraud, so that's a plus?

---

(Update)

## But someone will be!

⠀

After the exploit has been confirmed fixed, it was brought to my attention that several different events align suspiciously with the timing of this exploit, in no particular order:

1. [Mystic Coin price up +50% on the Trading Post](https://www.reddit.com/r/Guildwars2/comments/qyr7fc/mystic_coin_price_up_50_on_the_tp/) courtesy of /u/Shalaiyn

Mystic Coins are a relatively rare and relatively expensive resourse required to obtain best items in the game. According to /u/Smilko on reddit, The price has apparently [spiked by the factor of 4](https://www.reddit.com/r/Guildwars2/comments/qyr7fc/mystic_coin_price_up_50_on_the_tp/hli46zz/). 

2. [Other time-gated items going up in price](https://www.reddit.com/r/Guildwars2/comments/qzh95y/i_guess_thats_one_way_to_get_people_playing_the/) by /u/syanda

  In this post we see an item that's limited to 1 a day per account. The API [registered the staggering 6000% price spike](https://www.gw2tp.com/item/92077-iron-legion-key) caused by a mass buyout.
  
  ⠀
  
  ![Item prices going to the moon](./coins.png)
  
  ⠀

3. Twitch streamer [MightyTeapot gets messaged by a game moderator](https://clips.twitch.tv/AntsyTallOrcaPanicBasket-Txzsvpy00_O1xqfw) to delete fraudlent items that were donated to him using in-game mail

4. A wild screenshot appears, showing someone receiving **444** purchase confirmations from ArenaNet.
  
  ⠀
  
  ![444 purchase emails](https://i.imgur.com/AHa0wne.png)

  ⠀
  

Meanwhile, no official communication has yet taken place.
